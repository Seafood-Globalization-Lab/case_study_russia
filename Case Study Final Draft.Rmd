---
title: "Effects of the 2014 Russian Annexation of Crimea on Russian Seafood Trade"
author: "Joseph Barnes"
date: "2022-06-28"
output:
  html_document:
    toc: yes
    df_print: paged
  word_document:
    toc: yes
always_allow_html: yes
---




```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, message=FALSE)

library(tidyverse)
library(lubridate)
library(formatR)
library(RColorBrewer)
library(viridis)
library(janitor)
library(reader)
library(ggplot2)
library(ggrepel)
library(ggpubr)

library(cli)
library(devtools)
library(tidyverse)
library(sf)
library(cowplot)   # for theme_map()
library(lwgeom) # for st_transform_proj
library(ggsn) # for adding north arrows and scale bar
library(rworldmap) # for getMap()
#library(spData) # for world data
library(rnaturalearth)
# library(rnaturalearthhires)
library(rnaturalearthdata) # supporting data, only install/load if prompted 
library(gtrendsR)
library(knitr)
library(readr)
library(stringr)
library(ggthemes)
library(kableExtra)
library(countrycode)
library(ggridges)
library(dplyr)
library(networkD3)
library(RColorBrewer)
library(forcats)
library(circlize)
```

```{r, include=FALSE}
artis_russia_2009_2019 <- read_csv("C:/Users/User/Documents/American University/Global Seafood Lab/case_study_russia/20220629_josephbarnes_ARTIS_snet.csv", 
     col_types = cols(year = col_number())) %>%
  filter(year %in% c(2009:2019)) %>%
    mutate(sanctions_towards_russia = case_when(
      importer_iso3c %in% c("USA", "AUT", "BEL", "BGR", "HRV", "CYP", "CZE", "DNK", "EST", "FIN", "FRA", "DEU", "GRC", "HUN", "IRL", "ITA", "LVA", "LTU", "LUX", "MLT", "NLD", "POL", "PRT", "ROM", "SVK", "SVN", "ESP", "SWE", "GBR", "JPN", "ALB", "ISL", "AUS", "MNT", "UKR", "CAN", "NOR", "CHE", "MDA")  ~ "Yes",
      TRUE ~ "No"
    )) %>%
      mutate(exporter_sanctions_towards_russia = case_when(
      exporter_iso3c %in% c("USA", "AUT", "BEL", "BGR", "HRV", "CYP", "CZE", "DNK", "EST", "FIN", "FRA", "DEU", "GRC", "HUN", "IRL", "ITA", "LVA", "LTU", "LUX", "MLT", "NLD", "POL", "PRT", "ROM", "SVK", "SVN", "ESP", "SWE", "GBR", "JPN", "ALB", "ISL", "AUS", "MNT", "UKR", "CAN", "NOR", "CHE", "MDA")  ~ "Yes",
      TRUE ~ "No"))



```

```{r, include=FALSE, echo= FALSE}
artis_russia_2009_2019 <- clean_names(artis_russia_2009_2019)
artis_russia_2009_2019$hs6 <- str_pad(artis_russia_2009_2019$hs6, 6, pad = "0")
  

# str(artis_russia_2009_2019 %>%
# filter(year %in% 2010:2019)) # 487,324 x 14
# sort(unique(artis_russia_2009_2019$exporter_iso3c))
# sort(unique(artis_russia_2009_2019$importer_iso3c))
# unique(artis_russia_2009_2019$dom_source) # "foreign export"  "domestic export" "error export"  
# sort(unique(artis_russia_2009_2019$source_country_iso3c))
# unique(artis_russia_2009_2019$sci_name) # 1520
# unique(artis_russia_2009_2019$environment) # "marine"  "inland"  "unknown"
# unique(artis_russia_2009_2019$method) # "capture" "aquaculture" "unknown" 
# unique(artis_russia_2009_2019$hs_version) #HS 2, 7, 12


```

# Introduction

Russia began an annexation on Ukraine’s Crimean peninsula on March 18, 2014, sparking international tensions that imposed sanctions on Russia (Biersak, 2014). Sanctions included freezing Russian assets and capturing property to restrict Russian access to Western markets, aiming to cripple their banking, energy, and defense sectors; and banning exports to Russia of military technology and dual-use goods, including oil exploration and production equipment. (DeYoung; Christie). In response, Russia provided counter-sanctions as an agricultural embargo in 2014 that banned itself from importing food items, including seafood, from sanctioning nations (Wegren, 2018). With market data available from before and after the 2014 Annexation, this case study seeks to understand the seafood trade flow amid various embargoes and sanctions to better understand whose exports to Russia increased and whose decreased, and how much of that trade entered the market through third-party exporters to complete trades to and from Russia. Data from this case study can help predict market shifts and patterns to the current Ukrainian-Russian war that has seen similar sanctions and alliances rise up again.

```{r, echo=FALSE}
# russia <- ne_states(c(country = "Russia", "Ukraine", "Poland", "Belarus", "Moldova", "Romania"), returnclass = "sf")
# 
# Crimea <- data.frame(long = 35.382435, lat = 45.031933)
# 
# ggplot() +
#   geom_sf(data = russia, color = "black", fill = "darkseagreen")+ #size= 1) +
#   coord_sf(xlim = c(20.0, 60.0), ylim = c(40,60))+
#   geom_point(data = Crimea, color = "orangered", shape = 18, fill= "red", size = 5, aes(x = long, y = lat))+
#   theme(panel.grid.major = element_line(color = "lavenderblush4")) +
#   labs(title = "Crimean Peninsula")+
#   xlab("Longitude")+
#   ylab("Latitude")+
#   panel_border(color= "black", size = 2)+
#   theme(panel.background = element_rect(fill = "royalblue"))+
#   north(russia, location = "bottomright", symbol = 4,   scale= .03)+
# scalebar(russia, location = "bottomleft", transform = TRUE, dist_unit = "km", dist = 10, st.size = 5)

#  ylim = c(40,60)

#xlim = c(-76.5, -77.5), ylim = c(38.7, 39)
#, anchor = c(x= -77.5, y = 38.75

```

# Methods

Trade patterns from 2010 - 2019 were examined using the Aquatic Resource Trade in Species (ARTiS) database, tidied and visualized in R. ARTiS is also composed of Harmonized System (HS) data dating back to 1996, compiling updated seafood trade rosters every five years. HS includes a 4-digit code for a species categorization heading, species scientific names, and from which HS version the data comes from. Additional ARTiS data includes the production method (aquaculture or wild caught), the product and live weights (tons), and the year of the trade. The database was filtered for any seafood connection that was sourced in, exported to, or imported from Russia. 

The data was subset into two time periods of fives years before the annexation (2010-2014) and five years after (2015-2019) Since many of the sanctions were implemented or put in force in the summer or later in 2014, 2015 counts as the first full year after the annexation that results could be seen.

Structure (Rows x Columns) | Exporters | Importers | Source Countries | Scientific Names
-------- | -------- | -------- | -------- | -------- 
487,324 x 14 | 115 | 212 | 180 | 1520  
 
Countries are denoted with their 3-digit internationally standardized ISO code.


# Results

## Importers of Russian Seafood

The top 10 importers of Russian goods before (2010-2014) and after (2015-2019) the Crimean Annexation were garnered by subsetting the data by each time frame, and totaling the live weight for each importing country. These countries were manually input into a code to break up the live weight imports from Russia (exporter_iso3c == “RUS”) by year. The only country to drop as a top 10 importer after the 2014 Annexation was the United States, which seemingly stopped importing seafood products from Russia altogether. 


```{r, include= FALSE, echo=FALSE}
# Subsetting data into top 10 importers of Russian goods between 2012-2014, and 2014-2016. First, data is vectored into the top 10 importers for each time frame, with live weight totaled between the three years. Using the 10 countries from those datasets, they are then manually imported into a code that groups by year, so that it lists the top 10 importing countries and their totals in each year.
# 
# ** 7/15/2022 Removed source == "RUS" because I just want Russian exports, it doesn't matter where they came from yet.

# tmp <- artis_russia_2009_2019 %>%
#   filter(year %in% 2015:2019) %>%
#  filter( exporter_iso3c == "RUS") %>%
#  group_by(importer_iso3c) %>%
#  summarise(sum = sum(live_weight_t))%>%
#  arrange(desc(sum))

artis_10_14_top_10_with_years <- artis_russia_2009_2019 %>%
  filter(year %in% 2010:2014, exporter_iso3c == "RUS") %>%
  group_by(importer_iso3c, year, method, sanctions_towards_russia) %>%
  summarise(live_weight = sum(live_weight_t)) %>%
     arrange(desc(live_weight)) %>%
    filter(importer_iso3c == "CHN" | importer_iso3c == "KOR" | importer_iso3c == "NLD" | importer_iso3c == "JPN" | importer_iso3c == "BLR" | importer_iso3c == "UKR" | importer_iso3c == "DEU" | importer_iso3c == "FRA" | importer_iso3c == "USA" | importer_iso3c == "NGA")
artis_10_14_top_10_with_years$live_weight <-  round(artis_10_14_top_10_with_years$live_weight, digit = 2)



 artis_15_19_top_10_with_years <- artis_russia_2009_2019 %>%
   filter(year %in% 2015:2019, exporter_iso3c == "RUS") %>%
   group_by(importer_iso3c, year, method, sanctions_towards_russia) %>%
   summarise(live_weight = sum(live_weight_t)) %>%
       arrange(desc(live_weight)) %>%
   filter(importer_iso3c == "CHN" | importer_iso3c == "KOR" | importer_iso3c == "NLD" | importer_iso3c == "JPN" | importer_iso3c == "BLR" | importer_iso3c == "NGA" | importer_iso3c == "UKR" | importer_iso3c == "FRA" | importer_iso3c == "KAZ" | importer_iso3c == "DEU")
artis_15_19_top_10_with_years$live_weight <-  round(artis_15_19_top_10_with_years$live_weight, digit = 2)
# 
# 
artis_10_19_top_importers <- artis_russia_2009_2019 %>%
  filter(year %in% 2010:2019) %>%
    filter(exporter_iso3c == "RUS", source_country_iso3c == "RUS") %>%
  group_by(importer_iso3c, year, method, sanctions_towards_russia) %>%
  summarise(live_weight = sum(live_weight_t)) %>%
      arrange(desc(live_weight)) %>%
    filter(importer_iso3c == "CHN" | importer_iso3c == "KOR" | importer_iso3c == "JPN" | importer_iso3c == "NLD" | importer_iso3c == "BLR" | importer_iso3c == "UKR" | importer_iso3c == "DEU" | importer_iso3c == "FRA" | importer_iso3c == "USA" | importer_iso3c == "KAZ" | importer_iso3c == "NGA" | importer_iso3c == "KAZ"| importer_iso3c == "DEU"| importer_iso3c == "UKR")
```

```{r, include=FALSE, echo=FALSE}
# tmp <- artis_russia_2009_2019 %>%
#     filter(year %in% 2015:2019, exporter_iso3c == "RUS", method == "capture") %>%
#   group_by(importer_iso3c) %>%
#   summarise(live_weight = sum(live_weight_t)) %>%
#       arrange(desc(live_weight))

top_importers_all_years <-
  full_join(
    artis_10_14_top_10_with_years %>% group_by(importer_iso3c) %>% summarise(live_weight = sum(live_weight)),
    artis_15_19_top_10_with_years %>% group_by(importer_iso3c) %>%
      summarise(live_weight = sum(live_weight)),
    by = "importer_iso3c"
  ) %>%
  full_join(
    artis_russia_2009_2019 %>%
      filter(
        year %in% 2010:2014,
        exporter_iso3c == "RUS",
        method == "aquaculture"
      ) %>%
      group_by(importer_iso3c, year) %>%
      summarise(live_weight = sum(live_weight_t)) %>%
      arrange(desc(live_weight))  %>%
      filter(
        importer_iso3c == "KOR" |
          importer_iso3c == "CHN" |
          importer_iso3c == "UKR" |
          importer_iso3c == "JPN" |
          importer_iso3c == "NLD" |
          importer_iso3c == "BLR" |
          importer_iso3c == "DEU" |
          importer_iso3c == "KAZ" |
          importer_iso3c == "GBR" |
          importer_iso3c == "MDA"
      ) %>% group_by(importer_iso3c) %>% summarise(live_weight = sum(live_weight)),
    by = "importer_iso3c"
  ) %>%
  full_join(
    artis_russia_2009_2019 %>%
      filter(
        year %in% 2015:2019,
        exporter_iso3c == "RUS",
        method == "aquaculture"
      ) %>%
      group_by(importer_iso3c, year) %>%
      summarise(live_weight = sum(live_weight_t)) %>%
      arrange(desc(live_weight)) %>%
      filter(
        importer_iso3c == "CHN" |
          importer_iso3c == "KOR" |
          importer_iso3c == "BLR" |
          importer_iso3c == "UKR" |
          importer_iso3c == "JPN" |
          importer_iso3c == "KAZ" |
          importer_iso3c == "FRA" |
          importer_iso3c == "VNM" |
          importer_iso3c == "AZE" |
          importer_iso3c == "MDA"
      ) %>% group_by(importer_iso3c) %>% summarise(live_weight = sum(live_weight)),
    by = "importer_iso3c"
  ) %>%
  full_join(
    artis_russia_2009_2019 %>%
      filter(year %in% 2010:2014, exporter_iso3c == "RUS", method == "capture") %>%
      group_by(importer_iso3c, year) %>%
      summarise(live_weight = sum(live_weight_t)) %>%
      arrange(desc(live_weight)) %>%
      filter(
        importer_iso3c == "CHN" |
          importer_iso3c == "KOR" |
          importer_iso3c == "NLD" |
          importer_iso3c == "JPN" |
          importer_iso3c == "BLR" |
          importer_iso3c == "DEU" |
          importer_iso3c == "UKR" |
          importer_iso3c == "FRA" |
          importer_iso3c == "NGA" |
          importer_iso3c == "USA"
      ) %>% group_by(importer_iso3c) %>% summarise(live_weight = sum(live_weight)),
    by = "importer_iso3c"
  ) %>%
  full_join(
    artis_russia_2009_2019 %>%
      filter(year %in% 2015:2019, exporter_iso3c == "RUS", method == "capture") %>%
      group_by(importer_iso3c, year) %>%
      summarise(live_weight = sum(live_weight_t)) %>%
      arrange(desc(live_weight)) %>%
      filter(
        importer_iso3c == "CHN" |
          importer_iso3c == "KOR" |
          importer_iso3c == "NLD" |
          importer_iso3c == "JPN" |
          importer_iso3c == "BLR" |
          importer_iso3c == "NGA" |
          importer_iso3c == "UKR" |
          importer_iso3c == "FRA" |
          importer_iso3c == "DEU" |
          importer_iso3c == "KAZ"
      ) %>% group_by(importer_iso3c) %>% summarise(live_weight = sum(live_weight)),
    by = "importer_iso3c"
  )
colnames(top_importers_all_years) <-
  c(
    "Importer",
    "Live Weight 2010-2014 (Tons)",
    "Live Weight 2015-2019 (Tons)",
    "Aquaculture Live Weight 2010-2014 (Tons)",
    "Aquaculture Live Weight 2015-2019 (Tons)",
    "Capture Live Weight 2010-2014 (Tons)",
    "Capture Live Weight 2015-2019 (Tons)"
  )

tmp <- top_importers_all_years %>%
  select(-c(`Aquaculture Live Weight 2010-2014 (Tons)`:`Capture Live Weight 2015-2019 (Tons)`)) %>%
  slice(-c(12:15)) %>%
  arrange(desc(`Live Weight 2010-2014 (Tons)`))

  
  kable(tmp, caption = "Top 10 Importers of Russian Goods")
```

```{r, echo=FALSE}
  kable(tmp, caption = "Top 10 Importers of Russian Goods")
```


Germany, The United States, and South Korea all decreased their imports from Russia after the annexation, although only Germany and the United States had imposed sanctions on Russia and faced the agricultural embargo. Kazakhstan took the place of the USA in the top 10 importers after the annexation, but it was not enough to make up the difference from losses by the USA.

```{r, echo=FALSE, include = FALSE}
kable(top_importers_all_years, caption = "Top 10 Importers of Russian Goods")
```

Due to Russia's agricultural embargo counter-sanction, Russia ramped up domestic good production, primarily in capture fisheries. In most cases, importing countries bought more capture products than aquaculture, with the exceptions being Great Britain, Moldova, Azerbaijan, and Vietnam. Great Britain stopped importing goods from Russia after 2014, and neither Moldova, Azerbaijan, nor Vietman imported capture seafood in either time period. Azerbaijan and Vietnam did not import any aquaculture products prior to 2014, but did after.


```{r, echo=FALSE}
ggplot(artis_10_19_top_importers %>%
         group_by(importer_iso3c, year, sanctions_towards_russia)%>%
         summarise(live_weight = sum(live_weight)), aes(x= year, y= live_weight, fill = importer_iso3c))+
  geom_area()+
  facet_wrap(~sanctions_towards_russia)+
  ggtitle("Russian Seafood Importers", subtitle = "Faceted by Countries that Imposed Sanctions on Russia")+
  xlab("Year")+
  ylab("Live Weight (tons)") +
  geom_vline(xintercept=2014)  +
  guides(fill = guide_legend(title = "Importer of Russian Seafood"))+
  scale_x_continuous(n.breaks = 9)+
  theme(axis.text.x = element_text(angle = 90))+
  scale_y_continuous(breaks = seq(0,4000000,by = 500000))
```

This chart shows the top countries that imported the most seafood from Russia from 2010 to 2019, displaying the changes in top countries and import amounts before and after Annexation. Countries that did not implement sanctions against Russia in or around 2014 saw a sharp decrease in Russian seafood imports in 2014, followed by an immediate increase in the years to follow. South Korea's trade increased but by 2019, fell to around 2010 levels, lowering the total imports overall. Countries that did impose sanctions, on the other hand, increased their Russian imports into 2014. Although trade fell slightly in the years after, it still remained relatively constant to 2013 levels.


```{r, echo = FALSE, fig.width= 8}
full_join(artis_russia_2009_2019 %>%
  filter(year %in% 2010:2014, exporter_iso3c == "RUS") %>%
   group_by(importer_iso3c, sanctions_towards_russia) %>%
   summarise(`Live weight 2010-2014` = sum(live_weight_t)),
  artis_russia_2009_2019 %>%
    filter(year %in% 2015:2019, exporter_iso3c == "RUS") %>%
    group_by(importer_iso3c, sanctions_towards_russia) %>%
    summarise(`Live weight 2015-2019` = sum(live_weight_t)), by = "importer_iso3c") %>%
  pivot_longer(names_to = "time_period", values_to = "live_weight", 
               cols = c(`Live weight 2010-2014`,`Live weight 2015-2019`)) %>%
  arrange(desc(live_weight)) %>%
  filter(importer_iso3c == "CHN" | importer_iso3c == "KOR" | importer_iso3c == "JPN" | importer_iso3c == "NLD" | importer_iso3c == "BLR" | importer_iso3c == "UKR" | importer_iso3c == "DEU" | importer_iso3c == "FRA" | importer_iso3c == "USA" | importer_iso3c == "KAZ" | importer_iso3c == "NGA" | importer_iso3c == "KAZ"| importer_iso3c == "DEU"| importer_iso3c == "UKR") %>%
  ggplot(aes(x= time_period, y = live_weight, color = importer_iso3c, group = importer_iso3c))+
  geom_line() +
  geom_point() +
#  scale_color_discrete(, discrete = TRUE)+
  # scale_colour_brewer()+
  scale_color_brewer(palette = "Paired")+
  xlab("")+
  ylab("Live Weight (Tons)")+ 
  ggtitle("Total Russian Imports Before and After Annexation", subtitle = "Countries Importing Seafood from Russia Faceted by if they Imposed Sanctions on Russia") +
  guides(col = guide_legend(title = "Russian Seafood Importers"))+
  scale_y_continuous(breaks = seq(0, 8000000, by = 1000000))+
  scale_y_continuous(labels = scales::comma)+
#  geom_segment(x = as.numeric(time_period), xend = as.numeric(time_period), y = 0, yend = 1000000)+
  facet_wrap(~sanctions_towards_russia.x)+
  theme(axis.text.x = element_text(angle = 10))
```


Germany, USA, and South Korea all decreased their total imports after the 2014 Annexation, though only Germany and the United States implemented sanctions against Russia following the 2014 Annexation (Fackler). South Korea joined the sanctions in the Russian-Ukraine War in 2022 (North Macedonia). 

```{r, echo=FALSE}
top_importers_all_years %>%
  select(-c(`Aquaculture Live Weight 2010-2014 (Tons)`:`Capture Live Weight 2015-2019 (Tons)`))%>%
  slice(-c(11:15)) %>%
  replace(is.na(.), 0) %>%
  mutate(`Percent Change` = (`Live Weight 2015-2019 (Tons)` - `Live Weight 2010-2014 (Tons)`) / abs(`Live Weight 2015-2019 (Tons)`) * 100) %>%
      mutate(sanctions_towards_russia = case_when(
      Importer %in% c("USA", "AUT", "BEL", "BGR", "HRV", "CYP", "CZE", "DNK", "EST", "FIN", "FRA", "DEU", "GRC", "HUN", "IRL", "ITA", "LVA", "LTU", "LUX", "MLT", "NLD", "POL", "PRT", "ROM", "SVK", "SVN", "ESP", "SWE", "GBR", "JPN", "ALB", "ISL", "AUS", "MNT", "UKR", "CAN", "NOR", "CHE", "MDA")  ~ "Yes",
      TRUE ~ "No"
    )) %>%
  ggplot(aes(x = Importer, y = `Percent Change`)) +
  geom_segment(mapping = aes( x = 0, xend = `Percent Change`, y = Importer, yend = Importer, color = sanctions_towards_russia)) +
  geom_point(mapping = aes(x= `Percent Change`, y = Importer, color = sanctions_towards_russia))+
  xlab("Percent Change")+
  ylab("Importers")+
  ggtitle("Percent Change in Imports from Russia After Crimean Annexation") +
  guides(col = guide_legend(title = "Imposed Sanctions Against Russia"))+
      geom_vline(xintercept = 0)
  
```

Some importing nations had more drastic changes in imports before and after the Annexation than others. The USA and Germany, for example, saw over a 50% decrease in imports from Russia, while other countries like the Netherlands and Nigeria experienced a 50% increase in Russian imports. 

## Exporters to Russia
```{r, include=FALSE, echo=FALSE}
# Countries exporting to Russia (importer == RUS)

# tmp <- artis_russia_2009_2019 %>%
#     filter(year %in% 2015:2019, importer_iso3c == "RUS") %>%
#   group_by(exporter_iso3c) %>%
#   summarise(live_weight = sum(live_weight_t)) %>%
#       arrange(desc(live_weight))

top_exporters_all_years <-
  full_join(artis_russia_2009_2019 %>%
    filter(year %in% 2010:2014, importer_iso3c == "RUS") %>%
  group_by(exporter_iso3c) %>%
  summarise(live_weight = sum(live_weight_t)) %>%
  filter(exporter_iso3c == "NOR" |
          exporter_iso3c == "CHN" |
          exporter_iso3c == "ISL" |
          exporter_iso3c == "MAR" |
          exporter_iso3c == "DNK" |
          exporter_iso3c == "LVA" |
          exporter_iso3c == "VNM" |
          exporter_iso3c == "UKR" |
          exporter_iso3c == "CHL" |
          exporter_iso3c == "BLR"
      ) %>% group_by(exporter_iso3c) %>% summarise(live_weight = sum(live_weight)),
    artis_russia_2009_2019 %>%
    filter(year %in% 2015:2019, importer_iso3c == "RUS") %>%
  group_by(exporter_iso3c) %>%
  summarise(live_weight = sum(live_weight_t)) %>%
  filter(exporter_iso3c == "CHN" |
          exporter_iso3c == "DNK" |
          exporter_iso3c == "MRT" |
          exporter_iso3c == "CHL" |
          exporter_iso3c == "BLR" |
          exporter_iso3c == "VNM" |
          exporter_iso3c == "GRL" |
          exporter_iso3c == "IND" |
          exporter_iso3c == "MAR" |
          exporter_iso3c == "THA"
      ) %>% group_by(exporter_iso3c) %>% summarise(live_weight = sum(live_weight)),
  by = "exporter_iso3c") %>%
  arrange(desc(live_weight.x))

colnames(top_exporters_all_years) <-
  c(
    "Exporter",
    "Live Weight 2010-2014 (Tons)",
    "Live Weight 2015-2019 (Tons)")

artis_10_19_top_exporters <- artis_russia_2009_2019 %>%
  filter(year %in% 2010:2019) %>%
    filter(importer_iso3c == "RUS") %>%
  group_by(exporter_iso3c, year, method, exporter_sanctions_towards_russia) %>%
  summarise(live_weight = sum(live_weight_t)) %>%
      arrange(desc(live_weight)) %>%
    filter(exporter_iso3c == "NOR" |
          exporter_iso3c == "CHN" |
          exporter_iso3c == "ISL" |
          exporter_iso3c == "MAR" |
          exporter_iso3c == "DNK" |
          exporter_iso3c == "LVA" |
          exporter_iso3c == "VNM" |
          exporter_iso3c == "UKR" |
          exporter_iso3c == "CHL" |
          exporter_iso3c == "BLR" | 
          exporter_iso3c == "MRT" |
          exporter_iso3c == "DNK" |
          exporter_iso3c == "BLR" |
          exporter_iso3c == "IND" |
          exporter_iso3c == "GRL" |
          exporter_iso3c == "THA" )    
    
   
```

```{r, echo=FALSE}
kable(top_exporters_all_years, caption = "Top 10 Exporters to Russia")
```

Top seafood exporters to Russia include China, Iceland, Latvia, Morocco, Norway, and Ukraine, which all decreased total exports in the five years following the 2014 Annexation. Latvia, Iceland, Norway, and Ukraine stopped exporting to Russia completely due to the embargo. In their place, Greenland, India, Mauritania, and Thailand rose to the top 10 exporters to Russia. These replacements also did not make up the difference from the lost tonnage of Iceland, Latvia, Norway, and Ukraine.

```{r, echo=FALSE, message=FALSE}


ggplot(artis_10_19_top_exporters %>%
         group_by(exporter_iso3c, year, exporter_sanctions_towards_russia)%>%
         summarise(live_weight = sum(live_weight)), aes(x= year, y= live_weight, fill = exporter_iso3c))+
  geom_area()+
  facet_wrap(~exporter_sanctions_towards_russia)+
  ggtitle("Seafood Exporters to Russia", subtitle = "Faceted by if Counter-Sanction Embargo was Imposed")+
  xlab("Year")+
  ylab("Live Weight (Tons)") +
  geom_vline(xintercept=2014)  +
  guides(fill = guide_legend(title = "Exporter to Russia"))+
  scale_x_continuous(n.breaks = 10)+
  theme(axis.text.x = element_text(angle = 90))+
  scale_y_continuous(breaks = seq(0,1000000,by = 200000))+
  scale_y_continuous(labels = scales::comma)

```

China’s total exports decreased, but it seems that its rate of exports increased. Countries that did not impose sanctions initially saw dips in their exports to Russia, but they did pick back up in most cases. Exporters who were counter-sanctioned with the agricultural embargo saw export decreases to 0, except for Denmark, whose exports greatly increased after the Annexation, nearly tripling despite the embargo.

```{r, echo=FALSE, fig.width=6}
full_join(artis_russia_2009_2019 %>%
  filter(year %in% 2010:2014, importer_iso3c == "RUS") %>%
   group_by(exporter_iso3c, exporter_sanctions_towards_russia) %>%
   summarise(`Live weight 2010-2014` = sum(live_weight_t)),
  artis_russia_2009_2019 %>%
    filter(year %in% 2015:2019, importer_iso3c == "RUS") %>%
    group_by(exporter_iso3c, exporter_sanctions_towards_russia) %>%
    summarise(`Live weight 2015-2019` = sum(live_weight_t)), by = "exporter_iso3c") %>%
  pivot_longer(names_to = "time_period", values_to = "live_weight", 
               cols = c(`Live weight 2010-2014`,`Live weight 2015-2019`)) %>%
  arrange(desc(live_weight)) %>%
    filter(exporter_iso3c == "NOR" |
          exporter_iso3c == "CHN" |
          exporter_iso3c == "ISL" |
          exporter_iso3c == "MAR" |
          exporter_iso3c == "DNK" |
          exporter_iso3c == "LVA" |
          exporter_iso3c == "VNM" |
          exporter_iso3c == "UKR" |
          exporter_iso3c == "CHL" |
          exporter_iso3c == "BLR" | 
          exporter_iso3c == "MRT" |
          exporter_iso3c == "DNK" |
          exporter_iso3c == "BLR" |
          exporter_iso3c == "IND" |
          exporter_iso3c == "GRL" |
          exporter_iso3c == "THA" ) %>%
  ggplot(aes(x= time_period, y = live_weight, color = exporter_iso3c, group = exporter_iso3c))+
  geom_line() +
  geom_point() +
 # scale_color_brewer(palette = "Paired")+
  xlab("")+
  ylab("Live Weight (Tons)")+ 
  ggtitle("Total Exports Before and After Annexation", subtitle = "Countries Exporting Seafood to Russia Faceted by Russian Embargo Counter-Sanction") +
 guides(col = guide_legend(title = "Russian Seafood Exporters"))+
   scale_y_continuous(breaks = seq(0, 2000000, by = 2000000))+
  scale_y_continuous(labels = scales::comma)+  
#  geom_segment(x = as.numeric(time_period), xend = as.numeric(time_period), y = 0, yend = 1000000)+
  facet_wrap(~exporter_sanctions_towards_russia.x)+
    theme(axis.text.x = element_text(angle = 10))


```

Despite the initial dip in exports after the annexation, many countries' exports still increased overall between the two time periods. China and Morocco, in the countries who did not impose sanctions, saw their total exports fall, as did each country affected by the embargo, except for Denmark.
```{r, echo=FALSE}
top_exporters_all_years %>%
  replace(is.na(.), 0) %>%
  mutate(`Percent Change` = (`Live Weight 2015-2019 (Tons)` - `Live Weight 2010-2014 (Tons)`) / abs(`Live Weight 2015-2019 (Tons)`) * 100) %>%
      mutate(exporter_sanctions_towards_russia = case_when(
      Exporter %in% c("USA", "AUT", "BEL", "BGR", "HRV", "CYP", "CZE", "DNK", "EST", "FIN", "FRA", "DEU", "GRC", "HUN", "IRL", "ITA", "LVA", "LTU", "LUX", "MLT", "NLD", "POL", "PRT", "ROM", "SVK", "SVN", "ESP", "SWE", "GBR", "JPN", "ALB", "ISL", "AUS", "MNT", "UKR", "CAN", "NOR", "CHE", "MDA")  ~ "yes",
      TRUE ~ "no"
    )) %>%
  ggplot() +
  geom_segment(mapping = aes( x = 0, xend = `Percent Change`, y = Exporter, yend = Exporter, color = exporter_sanctions_towards_russia)) +
  geom_point(mapping = aes(x= `Percent Change`, y = Exporter, color = exporter_sanctions_towards_russia))+
  xlab("Percent Change")+
  ylab("Exporters")+
  ggtitle("Percent Change in Exports to Russia After Crimean Annexation") +
  guides(col = guide_legend(title = "Sanctions Imposed by Russia"))+
      geom_vline(xintercept = 0)
```

China's exports to Russia briefly decreased, but was on an upward trend. All countries with an embargo decreased their exports to 0, except for Denmark. Every other country that did not have the embargo increased their exports to Russia, except for Morocco and China. 


```{r, include= FALSE, echo=FALSE, fig.width=10,message=FALSE}

# Here is a further breakdown of trade changes between the top 10 trading countries by seafood production method.

# a <-  ggplot(artis_10_14_top_10_with_years %>%
#            group_by(importer_iso3c, sanctions_towards_russia) %>%
#            summarise(sum = sum(live_weight)),
#          aes(x = sanctions_towards_russia, y = importer_iso3c, fill = sum, label= round(sum))) +
#   geom_tile() + 
#   geom_text()+
#   xlab("")+
#   ylab("Importers")+
#   ggtitle("Seafood Imported from Russia 2010-2014")+
# guides(fill = guide_colorbar(barwidth = 25, barheight = .5), dist_units = "Tons")+
#      scale_fill_gradient(trans = "log", name = "Tons", n.breaks = 5, low = "deepskyblue3", high = "blue3")
# a
# 
# b <-  ggplot(artis_15_19_top_10_with_years %>%
#            group_by(importer_iso3c, sanctions_towards_russia) %>%
#            summarise(sum = sum(live_weight)),
#          aes(x = sanctions_towards_russia, y = importer_iso3c, fill = sum, label= round(sum))) +
#   geom_tile() + 
#   geom_text()+
#   xlab("")+
#   ylab("")+
#   ggtitle("Seafood Imported from Russia 2015-2019")+
#   guides(fill = guide_colorbar(barwidth = 25, barheight = .5), dist_unit = "Tons")+
#   scale_fill_gradient(trans = "log", name = "Tons", n.breaks = 5,  low = "deepskyblue3", high = "blue3")
# #

top_importers_all_years %>%
  select(Importer: `Live Weight 2015-2019 (Tons)`) %>%
  slice(-c(11:15)) %>%
  replace(is.na(.), 0) %>%
  rename(Importer = Importer, weight_2010_2014 = 'Live Weight 2010-2014 (Tons)', weight_2015_2019 = 'Live Weight 2015-2019 (Tons)') %>%
  mutate(Difference = weight_2015_2019 - weight_2010_2014) %>%
  mutate(sanctions_towards_russia = case_when(
      Importer %in% c("USA", "AUT", "BEL", "BGR", "HRV", "CYP", "CZE", "DNK", "EST", "FIN", "FRA", "DEU", "GRC", "HUN", "IRL", "ITA", "LVA", "LTU", "LUX", "MLT", "NLD", "POL", "PRT", "ROM", "SVK", "SVN", "ESP", "SWE", "GBR", "JPN", "ALB", "ISL", "AUS", "MNT", "UKR", "CAN", "NOR", "CHE", "MDA")  ~ "yes",
      TRUE ~ "no"
    )) %>%
  ggplot(aes(x = sanctions_towards_russia, y = Importer, fill = Difference, label = round(Difference)))+
  geom_tile() + 
  geom_text() +
  xlab("Sanctions Towards Russia") +
  ylab("") +
  ggtitle("Change in Russian Seafood Imports Before and After Annexation")+
  guides(fill = guide_colorbar(barheight = 10), dist_unit = "Tons")+
  scale_fill_gradient2(name = "Tons", limits = c(-200000, 2000000), low = "darkred", mid = "white", high = "navy", midpoint = 0) #colors = c("red", "green"))
        #              values = scales::rescale(identity(c(-200000, 0, 
         #                                        1, 2000000))))  
  
# barwidth = 25, 
#Change scale breaks
# Flip scale color gradient
  # , breaks = c(20, 400, 8000, 160000),
# ggarrange(a, b, ncol = 2, common.legend = TRUE)
```


## Species Trade

Trade trends with Russia can be seen when the imports and exports are broken down by the top species, rather than country. Russia stopped importing as many seafood goods due to its agricultural embargo, and instead increased domestic supply to become more agriculturally self-reliant and food secure (Wegner, 2018). It exported much more than it did prior to the Annexation, and exported more than it imported by an order of magnitude. Russia’s primary method was wild capture fisheries.


```{r, echo=FALSE, fig.width= 7}
# tmp <- artis_russia_2009_2019 %>%
#   filter(year %in% 2015:2019, exporter_iso3c == "RUS") %>%
#   mutate(hs_4digit = substr(hs6, 1, 4)) %>%
#   group_by(sci_name) %>%
#   summarise(live_weight = sum(live_weight_t)) %>%
#   arrange(desc(live_weight)) %>%
#   slice_max(order_by = live_weight, n = 10)

ggplot(artis_russia_2009_2019 %>%
         filter(year %in% 2010:2019) %>%
  filter( importer_iso3c == "RUS") %>%
 filter(sci_name == "clupea harengus" | sci_name == "osteichthyes" | sci_name == "salmo salar" | sci_name == "animalia" | sci_name == "scomber scombrus" | sci_name == "sardina pilchardus" | sci_name == "sprattus sprattus" | sci_name == "mallotus villosus" | sci_name == "actinopteri" | sci_name == "oncorhynchus mykiss" | sci_name == "pangasianodon hypophthalmus"| sci_name == "mytilus chilensis"))+
    geom_col(aes(x= year, y= live_weight_t, fill = sci_name))+
              facet_wrap(~method)+
  scale_color_solarized()+
  ggtitle("Top Russian Seafood Imports")+
  xlab("Year")+
  ylab("Live Weight (Tons)")+
  guides(fill = guide_legend(title = "Species"))+
  theme(axis.text.x = element_text(angle = 90)) +
  scale_y_continuous(breaks = seq(0,800000,by = 100000))+
  scale_y_continuous(labels = scales::comma)+
    scale_x_continuous(n.breaks = 10)+
  geom_vline(xintercept = 2014)
  

ggplot(artis_russia_2009_2019 %>%
         filter(exporter_iso3c == "RUS") %>%
        filter(sci_name == "gadus chalcogrammus" | sci_name == "gadus morhua" | sci_name == "clupea pallasii" | sci_name == "micromesistius poutassou" | sci_name == "oncorhynchus gorbuscha" | sci_name == "osteichthyes" | sci_name == "melanogrammus aeglefinus" | sci_name == "clupea harengus" | sci_name == "pleuronectiformes" | sci_name == "scomber scombrus" | sci_name == "animalia" | sci_name == "mallotus villosus" | sci_name == "pleuronectiformes")) +
    geom_col(aes(x= year, y= live_weight_t, fill = sci_name)) +
  facet_wrap(~method) +
#  theme_solarized()+
  scale_color_solarized()+
  ggtitle("Top Russian Seafood Exports")+
  xlab("Year")+
  ylab("Live Weight (Tons)")+
  guides(fill = guide_legend(title = "Species"))+
  theme(axis.text.x = element_text(angle = 90))+
    scale_y_continuous(breaks = seq(0,3000000,by = 200000))+
  scale_y_continuous(labels = scales::comma)+
  scale_x_continuous(n.breaks = 10)+
  geom_vline(xintercept = 2014)

```


```{r, include=FALSE}
# Animalia does not show up color-wise as great here because it spans multiple 4digit codes, whereas the ones above were grouped by sci name, not hs 4 digit code

ggplot(artis_russia_2009_2019 %>%
         filter(importer_iso3c == "RUS") %>%
  mutate(hs_4digit = substr(hs6, 1, 4)))+
    geom_col(aes(x= year, y= live_weight_t, fill = hs_4digit))+
                facet_wrap(~method)+
  theme_solarized()+
  scale_color_solarized()+
  ggtitle("Russian Seafood Imports")+
  xlab("Year")+
  ylab("Live Weight (t)")+
  guides(fill = guide_legend(title = "4 Digit HS Code"))+
  theme(axis.text.x = element_text(angle = 90))+
    scale_x_continuous(n.breaks = 10)+
  geom_vline(xintercept = 2014)

ggplot(artis_russia_2009_2019 %>%
         filter(exporter_iso3c == "RUS") %>%
  mutate(hs_4digit = substr(hs6, 1, 4)))+
    geom_col(aes(x= year, y= live_weight_t, fill = hs_4digit))+
                facet_wrap(~method)+
  theme_solarized()+
  scale_color_solarized()+
  ggtitle("Russian Seafood Exports")+
  xlab("Year")+
  ylab("Live Weight (t)")+
  guides(fill = guide_legend(title = "4 Digit HS Code"))+
  theme(axis.text.x = element_text(angle = 90))+
    scale_x_continuous(n.breaks = 10)+
  geom_vline(xintercept = 2014)
```

```{r, include=FALSE}
#Use these codes for expanding on importer/exporter species

top_exporters_species <- artis_russia_2009_2019 %>%
  filter(importer_iso3c == "RUS") %>%
      filter(exporter_iso3c == "CHL" |
          exporter_iso3c == "CHN" |
          exporter_iso3c == "DNK" |
          exporter_iso3c == "ISL" |
          exporter_iso3c == "LVA" |
          exporter_iso3c == "MAR" |
          exporter_iso3c == "MRT" |
          exporter_iso3c == "NOR" |
          exporter_iso3c == "UKR" |
          exporter_iso3c == "VNM" |
          exporter_iso3c == "BLR" |
          exporter_iso3c == "IND" )  %>%
  mutate(hs_4digit = substr(hs6, 1, 4)) %>%
  group_by(sci_name, exporter_iso3c) %>%
  summarise(live_weight = sum(live_weight_t)) %>%
  arrange(desc(live_weight)) %>%
  slice_max(order_by = live_weight, n = 10)
  
# 478 species alone in BLR, cannot graph that. Do top 10 species for each exporter?  

top_importers_species <- artis_russia_2009_2019 %>%
  filter(exporter_iso3c == "RUS") %>%
      filter(
        importer_iso3c == "BLR" |
          importer_iso3c == "CHN" |
          importer_iso3c == "DEU" |
          importer_iso3c == "FRA" |
          importer_iso3c == "JPN" |
          importer_iso3c == "KAZ" |
          importer_iso3c == "KOR" |
          importer_iso3c == "NLD" |
          importer_iso3c == "UKR" |
          importer_iso3c == "USA" |
          importer_iso3c == "NGA"
      )  %>%
  mutate(hs_4digit = substr(hs6, 1, 4)) %>%
  group_by(sci_name, importer_iso3c) %>%
  summarise(live_weight = sum(live_weight_t)) 
```

## Trade Changes 

Despite a Russian agricultural embargo counter-sanction, it still exported goods to whichever country would buy. This data shows seafood products that originated in Russia and were exported by Russia, compared to seafood that originated in Russia but was not directly exported by Russia.

```{r, include=FALSE}
# Playing around with import change to see if including 2014 made a difference in the data. When subtracted, it would basically zero itself out, which might not be a bad thing, still 5 years before and 5 years after. First graph is a lollipop showing trade changes with and without Russia (importing goods from Russia, Russia exports). The second graph shows the four quadrants of where countries fall in terms of total trade increased, Russian trade increased/ total trade increased, Russian trade increased/ total trade decreased, Russian trade decreased/ etc. 
# 
# Which countries imported more/less goods by weight from Russia?

russian_export_nation_change <- full_join(
  artis_russia_2009_2019 %>%
    filter(year %in% 2010:2014, exporter_iso3c == "RUS", source_country_iso3c == "RUS") %>%
    group_by(importer_iso3c) %>%
    summarise(exports_from_russia_2010_2014 = sum(live_weight_t)),
#     summarise(exports_from_russia_2009_2014 = sum(live_weight_t)/1)  
  artis_russia_2009_2019 %>%
    filter(year %in% 2015:2019, exporter_iso3c == "RUS", source_country_iso3c == "RUS") %>%
    group_by(importer_iso3c) %>%
    summarise(exports_from_russia_2015_2019 = sum(live_weight_t)), by = "importer_iso3c") %>%
  full_join(artis_russia_2009_2019 %>%
    filter(year %in% 2010:2014, exporter_iso3c != "RUS", source_country_iso3c == "RUS") %>%
    group_by(importer_iso3c) %>%
    summarise(nonrussian_exports_2010_2014 = sum(live_weight_t)), by = "importer_iso3c") %>%
  full_join(artis_russia_2009_2019 %>%
    filter(year %in% 2015:2019, exporter_iso3c != "RUS", source_country_iso3c == "RUS") %>%
    group_by(importer_iso3c) %>%
    summarise(nonrussian_exports_2015_2019 = sum(live_weight_t)),
  by = "importer_iso3c"
) %>%
  replace(is.na(.), 0) %>%
  mutate(
    russian_exports = case_when(
      exports_from_russia_2015_2019 > exports_from_russia_2010_2014 ~ "increased",
      exports_from_russia_2015_2019 < exports_from_russia_2010_2014 ~ "decreased",
      exports_from_russia_2015_2019 == exports_from_russia_2010_2014 ~ "no change"
    ), 
    russian_export_trade_change = exports_from_russia_2015_2019-exports_from_russia_2010_2014,
    nonrussian_export = case_when(
      nonrussian_exports_2015_2019 > nonrussian_exports_2010_2014 ~ "increased",
      nonrussian_exports_2015_2019 < nonrussian_exports_2010_2014 ~ "decreased",
      nonrussian_exports_2015_2019 == nonrussian_exports_2010_2014 ~ "no change"
    ), #nonrussian exports are the same thing as those countries' total imports excluding what came from Russia
    nonrussian_export_trade_change = nonrussian_exports_2015_2019-nonrussian_exports_2010_2014
  ) %>%
  mutate(
    russian_export_percentage = (
      exports_from_russia_2015_2019 / exports_from_russia_2010_2014
    ) * 100
  ) %>%
      mutate(exporter_sanctions_towards_russia = case_when(
      importer_iso3c %in% c("USA", "AUT", "BEL", "BGR", "HRV", "CYP", "CZE", "DNK", "EST", "FIN", "FRA", "DEU", "GRC", "HUN", "IRL", "ITA", "LVA", "LTU", "LUX", "MLT", "NLD", "POL", "PRT", "ROM", "SVK", "SVN", "ESP", "SWE", "GBR", "JPN", "ALB", "ISL", "AUS", "MNT", "UKR", "CAN", "NOR", "CHE", "MDA")  ~ "Yes",
      TRUE ~ "No"
    ))

#  tmp <- russian_export_nation_change %>%
#    filter(nonrussian_export == "increased", russian_exports == "decreased")
# unique(tmp$importer_iso3c)
# Countries whose total exports increased, but exports to Russia decreased- Chile, Colombia, Cyprus, Egypt Guatemala, Hong Kong, Hungary, Kyrgyzstan, Moldova, Mongolia, Slovenia, Sweden, Syria, Turkmenistan, Trinidad and Tobago, and Turkey

  
```


There were 16 countries whose total imports increased, but their import trade with Russia decreased- Chile, Colombia, Cyprus, Egypt, Guatemala, Hong Kong, Hungary, Kyrgyzstan, Moldova, Mongolia, Slovenia, Sweden, Syria, Turkmenistan, Trinidad and Tobago, and Turkey- indicating that Russia may have sent their products to a tertiary market before the goods were finally sent to these countries, but the indication probability is unknown. Of these countries, only Sweden, Hungary, and Moldova enacted sanctions against Russia, so their trade with Russia may have truly decreased, or, since their total imports increased, they may have ended up with goods that originated in Russia without dealing with Russia directly.

```{r, fig.height=6, fig.width=7, include=FALSE}


russian_export_nation_change %>%
  rename(`Russian Export Trade Change` = russian_export_trade_change, `Russia-exempt Export Trade Change` = nonrussian_export_trade_change) %>%
  filter(importer_iso3c != "CHN") %>%
  filter(abs(`Russian Export Trade Change`) > 10000 |
           abs(`Russia-exempt Export Trade Change`) > 10000) %>%
  select(importer_iso3c, `Russian Export Trade Change`, `Russia-exempt Export Trade Change`, exporter_sanctions_towards_russia) %>%
 # slice(-"CHN") %>%  
  pivot_longer(`Russian Export Trade Change`:`Russia-exempt Export Trade Change`, names_to = "trade_type", values_to = "trade_change") %>%
  ggplot()+
  geom_segment(mapping = aes( x = 0, xend = trade_change, y = importer_iso3c, yend = importer_iso3c, color = trade_type, group = importer_iso3c)) +
  geom_point(mapping = aes(x= trade_change, y = importer_iso3c, color = trade_type, group = importer_iso3c)) +
    geom_vline(xintercept = 0) +
    theme_bw()+
  xlab("Live Weight (Tons)")+
  ylab("Importers of Russian Goods")+
  ggtitle("Russian Importers Trade Change After Annexation", subtitle = "Faceted by Countries Who Place Sanctions on Russia")+
  guides(col = guide_legend(title = "Trade Type")) +
  facet_wrap(~exporter_sanctions_towards_russia)+
   scale_x_continuous(labels = scales::comma) 
#    theme(axis.text.x = element_text(angle = 10))

```

China was excluded to get a closer look at the countries with smaller import amounts. China's imports with Russia increased by around 1.5 million tons, while its imports from non-Russian countries declined. 


```{r, echo=FALSE, message=FALSE, warning=FALSE}

russian_export_nation_change %>% 
  ggplot(aes(x = russian_export_trade_change, y = nonrussian_export_trade_change, label = importer_iso3c, color = exporter_sanctions_towards_russia)) +
  geom_point() +
  geom_vline(xintercept = 0) +
  geom_hline(yintercept = 0) +
  geom_text_repel()+
  xlab("Imports Directly from Russia (Tons)")+
  ylab("Non-Russian Seafood Imports (Tons)") +
  ggtitle("Russian Imports Change after Annexation")+
    guides(col = guide_legend(title = "Imposed Sanctions on Russia"))+
  scale_y_continuous(breaks = seq(.250000, 100000, by = 100000))+
  scale_y_continuous(labels = scales::comma)


```

Non-Russian goods imported still originated in Russia, indicating a third-party route to obey sanctions but still do business with Russia. The x-axis displays seafood that originated in Russia and was exported by Russia, while the y-axis displays seafood that originated in Russia but was not exported by Russia.
Looking at the change in imports from Russia (Russian exports), the data can be broken into four categories: (clockwise from top left) direct Russian imports decrease, indirect Russian imports increase; direct Russian imports increase, indirect Russian imports increase; direct Russian imports increase, indirect Russian imports decrease; both direct and indirect imports from Russia decrease.

Although clustered, it appears that most nations who imposed sanctions against Russia saw an increase in imports directly from Russia and an increase in imports that originated from Russia. Japan, on the other hand, saw a noticeable decrease in tertiary Russian imports, but still an increase in direct imports from Russia.


```{r, include= FALSE, echo=FALSE}
# Next, we want to see changes in countries exporting goods to Russia, or change in Russian imports, between the two time periods. Specifically, if a nation’s total exports increased, but their exports to Russia decreased, where was the market shift?
# 
# Seven countries matched these criteria- Belarus, Brazil, Myanmar, Poland, Portugal, and Serbia. 

# Which countries did Russia import more/less goods from before and after 2014?

russian_import_change <- full_join(
  artis_russia_2009_2019 %>%
    filter(year %in% 2010:2014, importer_iso3c == "RUS") %>%
    group_by(exporter_iso3c) %>%
    summarise(russian_imports_2010_2014 = sum(live_weight_t)),
  artis_russia_2009_2019 %>%
    filter(year %in% 2015:2019, importer_iso3c == "RUS") %>%
    group_by(exporter_iso3c) %>%
    summarise(russian_imports_2015_2019 = sum(live_weight_t)),
  by = "exporter_iso3c"
) %>%
  full_join(
    artis_russia_2009_2019 %>%
      filter(year %in% 2010:2014) %>%
      group_by(exporter_iso3c) %>%
      summarise(total_imports_2010_2014 = sum(live_weight_t)),
    by = "exporter_iso3c"
  ) %>%
  full_join(
    artis_russia_2009_2019 %>%
      filter(year %in% 2015:2019) %>%
      group_by(exporter_iso3c) %>%
      summarise(total_imports_2015_2019 = sum(live_weight_t)),
    by = "exporter_iso3c"
  ) %>%
  replace(is.na(.), 0) %>%
  mutate(
    russian_import_change = case_when(
      russian_imports_2015_2019 > russian_imports_2010_2014 ~ "increased",
      russian_imports_2015_2019 < russian_imports_2010_2014 ~ "decreased",
      russian_imports_2015_2019 == russian_imports_2010_2014 ~ "no change"
    ),
    russian_import_change_weight = russian_imports_2015_2019 - russian_imports_2010_2014 ,
    total_imports = case_when(
      total_imports_2015_2019 > total_imports_2010_2014 ~ "increased",
      total_imports_2015_2019 < total_imports_2010_2014 ~ "decreased",
      total_imports_2015_2019 == total_imports_2010_2014 ~ "no change"
    ),
    total_trade_change = total_imports_2015_2019 - total_imports_2010_2014
  )  %>%
  mutate(exporter_sanctions_towards_russia = case_when(
    exporter_iso3c %in% c(
      "USA",
      "AUT",
      "BEL",
      "BGR",
      "HRV",
      "CYP",
      "CZE",
      "DNK",
      "EST",
      "FIN",
      "FRA",
      "DEU",
      "GRC",
      "HUN",
      "IRL",
      "ITA",
      "LVA",
      "LTU",
      "LUX",
      "MLT",
      "NLD",
      "POL",
      "PRT",
      "ROM",
      "SVK",
      "SVN",
      "ESP",
      "SWE",
      "GBR",
      "JPN",
      "ALB",
      "ISL",
      "AUS",
      "MNT",
      "UKR",
      "CAN",
      "NOR",
      "CHE",
      "MDA"
    )  ~ "yes",
    TRUE ~ "no"
  ))


tmp <- russian_import_change %>%
  filter(total_imports == "increased", russian_import_change == "decreased")
unique(tmp$exporter_iso3c)


# For countries whose exports decreased, did it go to other markets? Expand filter to all importers


#Exports to Russia decreased, total exports increased:
# "BEL" "BRA" "MMR" "PHL" "POL" "PRT" "SRB"


```

```{r, fig.cap="Filtered by Change greater than 10", fig.height=6, message=FALSE, include=FALSE}
russian_import_change %>%
  rename(`Russian Import Trade Change` = russian_import_change_weight, `Russia-exempt Import Trade Change` = total_trade_change) %>%
  filter(exporter_iso3c != "RUS") %>%
  filter(abs(`Russian Import Trade Change`) > 10000 |
           abs(`Russia-exempt Import Trade Change`) > 10000) %>%
  select(exporter_iso3c, `Russian Import Trade Change`, `Russia-exempt Import Trade Change`, exporter_sanctions_towards_russia) %>%
  pivot_longer(`Russian Import Trade Change`:`Russia-exempt Import Trade Change`, names_to = "trade_type", values_to = "trade_change") %>%
  ggplot()+
  geom_segment(mapping = aes( x = 0, xend = trade_change, y = exporter_iso3c, yend = exporter_iso3c, color = trade_type, group = exporter_iso3c)) +
  geom_point(mapping = aes(x= trade_change, y = exporter_iso3c, color = trade_type, group = exporter_iso3c)) +
    geom_vline(xintercept = 0) +
    theme_bw()+
  xlab("Live Weight (Tons)")+
  ylab("Exporters to Russia")+
  ggtitle("Russian Imports Trade Change after Annexation", subtitle = "Faceted by Embargoed Nations")+
  scale_x_continuous(breaks= seq(-2500000, 3000000, by = 1000000))+
  scale_x_continuous(labels= scales::comma) +
  facet_wrap(~exporter_sanctions_towards_russia)+
      guides(col = guide_legend(title = "Trade Type"))

```

There was little trade change in countries who did not face the embargo, but in countries that did, their total trade decreased, except for, again, Denmark. Russia did not import as many goods from China, even though it's exports to China increased. This was a common theme in Russian trade after the Annexation. In nations that faced the embargo, their total exports decreased as well.


```{r, echo=FALSE, message=FALSE, warning=FALSE}

  

russian_import_change %>% 
  ggplot(aes(x = russian_import_change_weight, y = total_trade_change, label = exporter_iso3c, color = exporter_sanctions_towards_russia)) +
  geom_point() +
  geom_vline(xintercept = 0) +
  geom_hline(yintercept = 0) +
  geom_text_repel()+
  xlab("Russian Imports (Tons)")+
  ylab("Non-Russian Imports (Tons)") +
  ggtitle("Russian Importers Trade Change", subtitle = "Change in Total Russian Imports between 2010-2014, and 2015-2019")+
    scale_x_continuous(breaks= seq(-2500000, 1000000, by = 1000000))+
  scale_x_continuous(labels= scales::comma)+
      guides(col = guide_legend(title = "Imposed Sanctions on Russia")) +
    scale_y_continuous(labels = scales::comma)



```

Here, too, there were four possibilities of trade change, listed clockwise from the top left quadrant- Russian imports decrease, total exports increased; Russian imports increase, total exports increased; Russian imports increase, total exports decreased; and all exports from that country decrease. All countries that placed sanctions on Russia, and therefore had the food embargo placed upon them, saw a decrease in Russian imports of their goods and a decrease in their total exports, except for Denmark, which saw an increase in both Russian and total trade. 

# Discussion

Countries that imposed sanctions on Russia, for the most part, still continued or increased their Russian seafood imports. The exceptions were Germany, and the USA. South Korea's imports also decreased, but it wouldn't adopt Western sanctions against Russia until the Russian-Ukrainian War in 2022. Still, with variable degrees of import changes indeterminate of sanction status, there is no clear trend to predict import changes.

Due to the embargo, many countries who imposed sanctions on Russia stopped exporting seafood products there. New countries rose up to fill their ranks, but their exports did not make up the difference of what Russia lost. This did not seem to impact Russia, however, as it ramped up domestic supply, mostly of capture fisheries. There is an inverse relationship between the trends of how much Russia imported and exported after the Annexation. Russia's domestic production allowed for an increase in Russian exports, presumably also supplying increased domestic food security and enriching the fishing economy.

The species did not change, either. The species trade was broken down to see if certain embargoed products were being reworked into a non-agricultural good, but the top HS codes did not change, and included HS 03, 05, 16, and 23, corresponding to fresh, chilled, or frozen fish and invertebrates; animal products; prepared seafood; and fish meal, respectively. No change in HS code trade shows that there was no tertiary market for alternate seafood goods trying to bypass the embargo.

This is shown, too, in total trade changes between Russia and the global seafood trade network. Most nations that enacted sanctions towards Russia saw an increase in imports directly from Russia and an increase in total imports originating in Russia. Their total exports, however, decreased, when they were banned from exporting to Russia. This may be a constraint of the data set, however, as every piece of data was connected to Russia in some way. The opposite happened in Denmark, which experienced an increase in both Russia and total trade. Future work may include expanding trade view around Denmark to include nations using Danish waters and docking in Denmark, or if embargoed nations traded more with Denmark.

The total trade decreases and unchanging HS codes show that there likely was no tertiary market that embargoed nations were using to get their seafood products to Russia. Overall, they were buying more goods, but selling less.

