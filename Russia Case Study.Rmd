---
title: "Russia Case Study"
author: "Joseph Barnes"
date: '2022-06-21'
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

library(tidyverse)
library(lubridate)
library(formatR)
library(RColorBrewer)
library(viridis)
library(janitor)
library(reader)

library(cli)
library(devtools)
library(tidyverse)
library(sf)
library(cowplot)   # for theme_map()
library(lwgeom) # for st_transform_proj
library(ggsn) # for adding north arrows and scale bar
library(rworldmap) # for getMap()
#library(spData) # for world data
library(rnaturalearth)
library(rnaturalearthdata) # supporting data, only install/load if prompted 
library(gtrendsR)
library(knitr)
library(readr)
library(stringr)
library(ggthemes)
library(kableExtra)
library(countrycode)
```

```{r}
artis_russia <- read_csv("C:/Users/User/Documents/American University/Global Seafood Lab/case_study_russia/20220616_josephbarnes_ARTIS_snet.csv", 
     col_types = cols(year = col_number())) 

```

```{r}
artis_russia <- clean_names(artis_russia)
artis_russia$hs6 <- str_pad(artis_russia$hs6, 6, pad = "0")
  

str(artis_russia) # 246,373 x 12
unique(artis_russia$exporter_iso3c)
unique(artis_russia$importer_iso3c)
unique(artis_russia$dom_source) # "foreign export"  "domestic export" "error export"  
unique(artis_russia$source_country_iso3c)
unique(artis_russia$sci_name) # > 999 
unique(artis_russia$environment) # "marine"  "inland"  "unknown"
unique(artis_russia$method) # "capture" "aquaculture" "unknown" 
unique(artis_russia$hs_version) #HS12
unique(artis_russia$year) # 2012, 13, 14, 15, 16

```
  Exporters:
  [1] "ARE" "ARG" "ARM" "AUS" "AUT" "BEL" "BGD" "BGR" "BLR" "BRA" "CAN" "CHE" "CHL" "CHN" "COL" "CYP"
 [17] "CZE" "DEU" "DNK" "ECU" "EGY" "ESP" "EST" "FIN" "FLK" "FRA" "GBR" "GEO" "GRC" "GRL" "HKG" "HRV"
 [33] "HUN" "IDN" "IND" "IRL" "ISL" "ISR" "ITA" "JPN" "KAZ" "KOR" "LBN" "LKA" "LTU" "LVA" "MAR" "MDA"
 [49] "MDV" "MEX" "MRT" "MYS" "NGA" "NIC" "NLD" "NOR" "NZL" "PAK" "PER" "POL" "PRT" "RUS" "SAU" "SGP"
 [65] "SRB" "SVK" "SVN" "SWE" "SYC" "THA" "TUN" "TUR" "TWN" "UGA" "UKR" "URY" "USA" "UZB" "VNM" "YEM"
 [81] "ZAF" "AZE" "FJI" "GHA" "KGZ" "MLT" "PHL" "PRK" "TJK" "BHR" "CMR" "FSM" "IRN" "MMR" "MNG" "OMN"
 [97] "TZA" "BFA" "CIV" "KEN" "NAM" "TGO" "BEN" "MUS" "SEN"


Importers:
Show in New Window
  [1] "CAN" "CIV" "HKG" "MDV" "OMN" "PAK" "QAT" "SDN" "RUS" "CHN" "JPN" "MYS" "SGP" "THA" "TWN" "CHE"
 [17] "DEU" "FRA" "GRC" "HUN" "NLD" "POL" "SVK" "SVN" "AUS" "AUT" "CZE" "DNK" "ESP" "FIN" "GBR" "IRL"
 [33] "ISR" "ITA" "LTU" "MLT" "NGA" "NOR" "PRT" "ROU" "SWE" "ARM" "AZE" "EST" "GEO" "KAZ" "MDA" "NZL"
 [49] "TKM" "UKR" "USA" "ATG" "BRA" "BRB" "CUW" "DMA" "DOM" "GRD" "GTM" "HTI" "IDN" "ISL" "JAM" "KOR"
 [65] "MAC" "MEX" "SUR" "TTO" "VNM" "ZAF" "ARG" "BOL" "PER" "ABW" "AGO" "ALB" "ARE" "BEL" "BGD" "BGR"
 [81] "BHR" "BIH" "BLR" "BRN" "CHL" "CMR" "COD" "COG" "COL" "CRI" "CUB" "CYP" "DZA" "EGY" "FJI" "GHA"
 [97] "GIN" "GNQ" "HND" "HRV" "IND" "IRN" "JOR" "KGZ" "KWT" "LBN" "LBY" "LKA" "LVA" "MAR" "MDG" "MMR"
[113] "MOZ" "MUS" "MYT" "NAM" "NIC" "PAN" "PHL" "PRK" "SAU" "SRB" "TGO" "TUN" "TUR" "URY" "WSM" "ZWE"
[129] "AFG" "MKD" "PYF" "GRL" "CPV" "GIB" "UZB" "DJI" "GAB" "NCL" "SEN" "SPM" "TCD" "ECU" "LCA" "GUM"
[145] "KHM" "SLB" "TJK" "VGB" "BEN" "BLZ" "GNB" "IRQ" "KEN" "LBR" "MNG" "MNP" "PLW" "PRY" "VUT" "MNE"
[161] "STP" "TLS" "VEN" "IOT" "LAO" "YEM" "BHS" "CYM" "SLV" "SXM" "BWA" "LSO" "SWZ" "ZMB" "SYC" "VCT"
[177] "BMU" "COM" "PNG" "SOM" "TON" "TZA" "MLI" "BFA" "SLE" "GMB" "MRT" "NER" "RWA" "UGA" "SYR" "ETH"
[193] "FSM" "GUY" "KIR" "MWI" "NPL" "PSE" "CAF" "BLM" "TCA" "MHL" "WLF" "KNA"

Source Country:
Show in New Window
  [1] "RUS"     "ARG"     "BRA"     "CHL"     "unknown" "ARM"     "ITA"     "ESP"     "GEO"    
 [10] "NOR"     "AUS"     "NZL"     "USA"     "CHN"     "TWN"     "PHL"     "KOR"     "VNM"    
 [19] "NAM"     "MMR"     "IDN"     "ZAF"     "BGD"     "BEL"     "DNK"     "NLD"     "BGR"    
 [28] "FRA"     "GRC"     "MAR"     "TUR"     "LTU"     "BLR"     "POL"     "ISR"     "ISL"    
 [37] "LVA"     "EST"     "GBR"     "CAN"     "URY"     "UKR"     "IND"     "KAZ"     "ECU"    
 [46] "DEU"     "IRL"     "FIN"     "PER"     "THA"     "JPN"     "COL"     "GUY"     "SPM"    
 [55] "PAK"     "PRT"     "SGP"     "HKG"     "HND"     "SUR"     "MEX"     "SWE"     "GHA"    
 [64] "SEN"     "LKA"     "MYS"     "GRL"     "FSM"     "MDV"     "MHL"     "PNG"     "VUT"    
 [73] "FJI"     "COK"     "MUS"     "OMN"     "PRK"     "KEN"     "TZA"     "YEM"     "MOZ"    
 [82] "BRN"     "GTM"     "KHM"     "BEN"     "ARE"     "MDG"     "IRN"     "MRT"     "DOM"    
 [91] "GMB"     "PAN"     "CYP"     "CZE"     "HUN"     "AUT"     "ROU"     "SYC"     "JOR"    
[100] "FLK"     "BLZ"     "CPV"     "CUW"     "CIV"     "MLT"     "MYT"     "SHN"     "HRV"    
[109] "DZA"     "TUN"     "NIC"     "SVK"     "VEN"     "ATF"     "BHS"     "CUB"     "NGA"    
[118] "ALB"     "WSM"     "SLB"     "SAU"     "CRI"     "GIN"     "TUV"     "BHR"     "CHE"    
[127] "KWT"     "UGA"     "EGY"     "IOT"     "ZMB"     "VGB"     "KIR"     "SLV"     "LBY"    
[136] "GNQ"     "IRQ"     "TTO"     "SVN"     "MNG"     "AGO"     "JAM"     "AZE"     "SLE"    
[145] "LBN"     "SRB"     "LAO"     "ASM"     "GRD"     "PYF"     "BRB"     "COG"     "BIH"    
[154] "GNB"     "ATG"     "COM"     "LBR"     "GAB"     "TON"     "UZB"     "MKD"     "VCT"    
[163] "SOM"     "MAC"     "NCL"     "BOL"     "KGZ"  

![ISO 3 Codes](https://www.researchgate.net/profile/Chahir-Zaki/publication/23779008/figure/tbl7/AS:669253044801551@1536573768865/List-of-countries-by-code-iso-3.png)

Foreign Export = Selling goods outside a country's borders
Domestic Export = goods originated from exporting country 
Error Export = 

```{r}
artis_12_14 <- artis_russia %>%
  filter(year == 2012:2014)
# 2014 ends around row 153,000

artis_14_16 <- artis_russia %>%
  filter(year == 2014:2016)

aquaculture_12_14 <- artis_russia %>% 
  filter(year == 2012:2014) %>%
  filter(method == "aquaculture")

aquaculture_14_16 <- artis_russia %>% 
  filter(year == 2014:2016) %>%
  filter(method == "aquaculture")

capture_12_14 <- artis_russia %>% 
  filter(year == 2012:2014) %>%
  filter(method == "capture")

capture_14_16 <- artis_russia %>% 
  filter(year == 2014:2016) %>%
  filter(method == "capture")




artis_12_14_top_10 <- artis_12_14 %>%
  filter(exporter_iso3c == "RUS", source_country_iso3c == "RUS") %>% 
    mutate(hs_4digit = substr(hs6, 1, 4)) %>%
  group_by(importer_iso3c) %>%
  summarise(sum = sum(product_weight_t)) %>%
      arrange(desc(sum)) %>% 
    slice_max(order_by = sum, n=10)

artis_12_14_top_10_with_years <- artis_12_14 %>%
  filter(exporter_iso3c == "RUS", source_country_iso3c == "RUS") %>% 
  group_by(importer_iso3c, year, method) %>%
  summarise(sum = sum(product_weight_t)) %>%
      arrange(desc(sum)) %>%
    filter(importer_iso3c == "CHN" | importer_iso3c == "KOR" | importer_iso3c == "NLD" | importer_iso3c == "JPN" | importer_iso3c == "BLR" | importer_iso3c == "NGA" | importer_iso3c == "USA" | importer_iso3c == "DEU" | importer_iso3c == "THA" | importer_iso3c == "KAZ")

artis_14_16_top_10 <- artis_14_16 %>%
  filter(exporter_iso3c == "RUS", source_country_iso3c == "RUS") %>% 
    mutate(hs_4digit = substr(hs6, 1, 4)) %>%
  group_by(importer_iso3c) %>%
  summarise(sum = sum(product_weight_t)) %>%
      arrange(desc(sum)) %>% 
    slice_max(order_by = sum, n=10)

artis_14_16_top_10_with_years <- artis_14_16 %>%
  filter(exporter_iso3c == "RUS", source_country_iso3c == "RUS") %>% 
#    mutate(hs_4digit = substr(hs6, 1, 4)) %>%
  group_by(importer_iso3c, year, method) %>%
  summarise(sum = sum(product_weight_t)) %>%
      arrange(desc(sum)) %>%
    #slice_max(order_by = sum, n=10)
  filter(importer_iso3c == "CHN" | importer_iso3c == "KOR" | importer_iso3c == "JPN" | importer_iso3c == "NLD" | importer_iso3c == "BLR" | importer_iso3c == "FRA" | importer_iso3c == "NGA" | importer_iso3c == "NOR" | importer_iso3c == "POL" | importer_iso3c == "USA")






```

Aquaculture subsets
```{r}
aquaculture_12_14_top10 <- aquaculture_12_14 %>%
    filter(exporter_iso3c == "RUS", source_country_iso3c == "RUS") %>% 
  group_by(importer_iso3c) %>%
  summarise(sum = sum(product_weight_t)) %>%
      arrange(desc(sum)) %>% 
    slice_max(order_by = sum, n=10)

aquaculture_12_14_top10_years <- aquaculture_12_14 %>%
    filter(exporter_iso3c == "RUS", source_country_iso3c == "RUS") %>% 
  group_by(importer_iso3c, year) %>%
  summarise(sum = sum(product_weight_t)) %>%
      arrange(desc(sum)) %>% 
  filter(importer_iso3c == "KOR" | importer_iso3c == "JPN" | importer_iso3c == "BLR" | importer_iso3c == "CHN" | importer_iso3c == "KAZ" | importer_iso3c == "HKG" | importer_iso3c == "USA" | importer_iso3c == "UKR" | importer_iso3c == "POL" | importer_iso3c == "DEU")





aquaculture_14_16_top10 <- aquaculture_14_16 %>%
    filter(exporter_iso3c == "RUS", source_country_iso3c == "RUS") %>% 
  group_by(importer_iso3c) %>%
  summarise(sum = sum(product_weight_t)) %>%
      arrange(desc(sum)) %>% 
    slice_max(order_by = sum, n=10)

aquaculture_14_16_top10_years <- aquaculture_14_16 %>%
    filter(exporter_iso3c == "RUS", source_country_iso3c == "RUS") %>% 
  group_by(importer_iso3c, year) %>%
  summarise(sum = sum(product_weight_t)) %>%
      arrange(desc(sum)) %>% 
  filter(importer_iso3c == "CHN" | importer_iso3c == "KOR" | importer_iso3c == "BLR" | importer_iso3c == "JPN" | importer_iso3c == "KAZ" | importer_iso3c == "UKR" | importer_iso3c == "VNM" | importer_iso3c == "LTU" | importer_iso3c == "USA" | importer_iso3c == "DEU")
```

Capture Subsets
```{r}
capture_12_14_top10 <- capture_12_14 %>%
    filter(exporter_iso3c == "RUS", source_country_iso3c == "RUS") %>% 
  group_by(importer_iso3c) %>%
  summarise(sum = sum(product_weight_t)) %>%
      arrange(desc(sum)) %>% 
    slice_max(order_by = sum, n=10)

capture_12_14_top10_years <- capture_12_14 %>%
    filter(exporter_iso3c == "RUS", source_country_iso3c == "RUS") %>% 
  group_by(importer_iso3c, year) %>%
  summarise(sum = sum(product_weight_t)) %>%
      arrange(desc(sum)) %>% 
  filter(importer_iso3c == "CHN" | importer_iso3c == "KOR" | importer_iso3c == "NLD" | importer_iso3c == "JPN" | importer_iso3c == "BLR" | importer_iso3c == "NGA" | importer_iso3c == "USA" | importer_iso3c == "DEU" | importer_iso3c == "THA" | importer_iso3c == "KAZ")




capture_14_16_top10 <- capture_14_16 %>%
    filter(exporter_iso3c == "RUS", source_country_iso3c == "RUS") %>% 
  group_by(importer_iso3c) %>%
  summarise(sum = sum(product_weight_t)) %>%
      arrange(desc(sum)) %>% 
    slice_max(order_by = sum, n=10)

capture_14_16_top10_years <- capture_14_16 %>%
    filter(exporter_iso3c == "RUS", source_country_iso3c == "RUS") %>% 
  group_by(importer_iso3c, year) %>%
  summarise(sum = sum(product_weight_t)) %>%
      arrange(desc(sum)) %>% 
  filter(importer_iso3c == "CHN" | importer_iso3c == "KOR" | importer_iso3c == "JPN" | importer_iso3c == "NLD" | importer_iso3c == "BLR" | importer_iso3c == "FRA" | importer_iso3c == "NGA" | importer_iso3c == "NOR" | importer_iso3c == "POL" | importer_iso3c == "USA")

tmp <- artis_russia %>%
  filter(exporter_iso3c == "RUS") %>%
  group_by(importer_iso3c, exporter_iso3c, year, product_weight_t) %>%
  mutate(change = case_when(
    product_weight > 0 ~ "increased",
    product_weight <= 0 ~ "decreased"
  ))

```



```{r}
colnames(artis_12_14_top_10) <- c("Importer", "2012-2014 Product Weight (t)")
colnames(artis_14_16_top_10) <- c("Importer", "2014-2016 Product Weight (t)")
Top_10_12_16 <- full_join(artis_12_14_top_10, artis_14_16_top_10, by = "Importer") %>%
  arrange(desc("2012-2014 Product Weight (t)", "2014-2016 Product Weight (t)"))

kable(Top_10_12_16, caption = "Top 10 Importers of Russian Goods")
```
Doesn't work yet- can I determine which countries' exports to Russia increased/decreased, which countries' Russian imports increased/decreased, and how the method was affected?

Do that with each 12-14, 14-16 data set, and then join data sets for total?
```{r}
tmp <- aquaculture_12_14 %>%
  group_by(importer_iso3c, exporter_iso3c, year) %>%
  summarise(product_weight = sum(product_weight_t))

artis_percentages <- artis_russia %>%
  group_by(importer_iso3c, exporter_iso3c, method, year) %>%
  summarise(product_weight = sum(product_weight_t)) %>%
  mutate(method_percentage = percent(product_weight/method))
```

```{r}


ggplot()+
  geom_area(artis_12_14_top_10_with_years, mapping = aes(x= year, y= sum, fill= importer_iso3c))+
  geom_area(artis_14_16_top_10_with_years, mapping = aes(x= year, y= sum, fill= importer_iso3c))  +
  facet_wrap(~method)


```
```{r}

```


```{r}
ggplot(artis_14_16_aquaculture %>%
         filter(importer_iso3c == "RUS"))+
  geom_col(aes(x = sci_name, y = product_weight_t, fill = environment))+
  facet_wrap(~year)+
  theme(axis.text.x = element_text(angle = 90))

ggplot(artis_12_14_aquaculture %>%
         filter(importer_iso3c == "RUS"))+
  geom_col(aes(x = sci_name, y = product_weight_t, fill = environment))+
  facet_wrap(~year)+
  theme(axis.text.x = element_text(angle = 90))

ggplot(artis_12_14_exporter_russia)+
  geom_line(aes(x= year, y= product_weight_t, fill= hs_4digit))

ggplot(artis_12_14)+
  geom_point(aes(y= product_weight_t, x = live_weight_t, fill = method))
```

```{r}
russia <- ne_states(c(country = "Russia", "Ukraine"), returnclass = "sf")

Crimea <- data.frame(long = 35.382435, lat = 45.031933)

ggplot() +
  geom_sf(data = russia, color = "black", fill = "darkseagreen", size= 1) +
  coord_sf(xlim = c(20.0, 60.0))+
  geom_point(data = Crimea, color = "orangered", shape = 18, fill= "red", size = 5, aes(x = long, y = lat))+
  theme(panel.grid.major = element_line(color = "lavenderblush4")) +
  labs(title = "Crimean Peninsula")+
  xlab("Longitude")+
  ylab("Latitude")+
  panel_border(color= "black", size = 2)+
  theme(panel.background = element_rect(fill = "royalblue"))+
  north(russia, location = "bottomright", symbol = 4,   scale= .03)+
scalebar(russia, location = "bottomleft", transform = TRUE, dist_unit = "km", dist = 10, st.size = 5)

#xlim = c(-76.5, -77.5), ylim = c(38.7, 39)
#, anchor = c(x= -77.5, y = 38.75

```



Not used:
```{r}
artis_12_13 <- artis_russia %>%
  filter(year == 2012:2013)

artis_14 <- artis_russia %>%
  filter(year == 2014)

artis_15_16 <- artis_russia %>%
  filter(year == 2015:2016)

aquaculture_12_13 <- artis_12_13 %>% 
  filter(year == 2012:2013) %>%
  filter(method == "aquaculture")

aquaculture_12_13_top10 <- aquaculture_12_13 %>%
    filter(exporter_iso3c == "RUS", source_country_iso3c == "RUS") %>% 
  group_by(importer_iso3c) %>%
  summarise(sum = sum(product_weight_t)) %>%
      arrange(desc(sum)) %>% 
    slice_max(order_by = sum, n=10)

aquaculture_12_13_top10_years <- aquaculture_12_13 %>%
    filter(exporter_iso3c == "RUS", source_country_iso3c == "RUS") %>% 
  group_by(importer_iso3c, year) %>%
  summarise(sum = sum(product_weight_t)) %>%
      arrange(desc(sum)) %>% 
  filter(importer_iso3c == "JPN" | importer_iso3c == "KOR" | importer_iso3c == "BLR" | importer_iso3c == "CHN" | importer_iso3c == "DEU" | importer_iso3c == "UKR" | importer_iso3c == "KAZ" | importer_iso3c == "POL" | importer_iso3c == "EST" | importer_iso3c == "USA")

capture_12_13 <- artis_russia %>% 
  filter(year == 2012:2013) %>%
  filter(method == "capture")

capture_12_13_top10 <- capture_12_13 %>%
    filter(exporter_iso3c == "RUS", source_country_iso3c == "RUS") %>% 
  group_by(importer_iso3c) %>%
  summarise(sum = sum(product_weight_t)) %>%
      arrange(desc(sum)) %>% 
    slice_max(order_by = sum, n=10)

capture_12_13_top10_years <- capture_12_13 %>%
    filter(exporter_iso3c == "RUS", source_country_iso3c == "RUS") %>% 
  group_by(importer_iso3c, year) %>%
  summarise(sum = sum(product_weight_t)) %>%
      arrange(desc(sum)) %>% 
  filter(importer_iso3c == "KOR" | importer_iso3c == "CHN" | importer_iso3c == "JPN" | importer_iso3c == "NLD" | importer_iso3c == "NGA" | importer_iso3c == "USA" | importer_iso3c == "BLR" | importer_iso3c == "NOR" | importer_iso3c == "FRA" | importer_iso3c == "DEU")



aquaculture_14 <- artis_russia %>% 
  filter(year == 2014) %>%
  filter(method == "aquaculture")

aquaculture_14_top10 <- aquaculture_14 %>%
    filter(exporter_iso3c == "RUS", source_country_iso3c == "RUS") %>% 
  group_by(importer_iso3c) %>%
  summarise(sum = sum(product_weight_t)) %>%
      arrange(desc(sum)) %>% 
    slice_max(order_by = sum, n=10)

aquaculture_14_top10_years <- aquaculture_14 %>%
    filter(exporter_iso3c == "RUS", source_country_iso3c == "RUS") %>% 
  group_by(importer_iso3c, year) %>%
  summarise(sum = sum(product_weight_t)) %>%
      arrange(desc(sum)) %>% 
  filter(importer_iso3c == "KOR" | importer_iso3c == "CHN" | importer_iso3c == "JPN" | importer_iso3c == "BLR" | importer_iso3c == "KAZ" | importer_iso3c == "HKG" | importer_iso3c == "VNM" | importer_iso3c == "UKR" | importer_iso3c == "DEU" | importer_iso3c == "USA")

capture_14 <- artis_russia %>% 
  filter(year == 2014) %>%
  filter(method == "capture")
  
capture_14_top10 <- capture_14 %>%
    filter(exporter_iso3c == "RUS", source_country_iso3c == "RUS") %>% 
  group_by(importer_iso3c) %>%
  summarise(sum = sum(product_weight_t)) %>%
      arrange(desc(sum)) %>% 
    slice_max(order_by = sum, n=10)

capture_14_top10_years <- capture_14 %>%
    filter(exporter_iso3c == "RUS", source_country_iso3c == "RUS") %>% 
  group_by(importer_iso3c, year) %>%
  summarise(sum = sum(product_weight_t)) %>%
      arrange(desc(sum)) %>% 
  filter(importer_iso3c == "CHN" | importer_iso3c == "KOR" | importer_iso3c == "NLD" | importer_iso3c == "JPN" | importer_iso3c == "BLR" | importer_iso3c == "NGA" | importer_iso3c == "USA" | importer_iso3c == "DEU" | importer_iso3c == "POL" | importer_iso3c == "FRA")



artis_15_16 <- artis_russia %>%
  filter(year == 2015:2016)

aquaculture_15_16 <- artis_russia %>% 
  filter(year == 2015:2016) %>%
  filter(method == "aquaculture")

aquaculture_15_16_top10 <- aquaculture_15_16 %>%
    filter(exporter_iso3c == "RUS", source_country_iso3c == "RUS") %>% 
  group_by(importer_iso3c) %>%
  summarise(sum = sum(product_weight_t)) %>%
      arrange(desc(sum)) %>% 
    slice_max(order_by = sum, n=10)

aquaculture_15_16_top10_years <- aquaculture_15_16 %>%
    filter(exporter_iso3c == "RUS", source_country_iso3c == "RUS") %>% 
  group_by(importer_iso3c, year) %>%
  summarise(sum = sum(product_weight_t)) %>%
      arrange(desc(sum)) %>% 
  filter(importer_iso3c == "JPN" | importer_iso3c == "KOR" | importer_iso3c == "BLR" | importer_iso3c == "CMR" | importer_iso3c == "KAZ" | importer_iso3c == "UKR" | importer_iso3c == "CHN" | importer_iso3c == "LTU" | importer_iso3c == "DEU" | importer_iso3c == "USA")

capture_15_16 <- artis_russia %>% 
  filter(year == 2015:2016) %>%
  filter(method == "capture")
  
capture_15_16_top10 <- capture_15_16 %>%
    filter(exporter_iso3c == "RUS", source_country_iso3c == "RUS") %>% 
  group_by(importer_iso3c) %>%
  summarise(sum = sum(product_weight_t)) %>%
      arrange(desc(sum)) %>% 
    slice_max(order_by = sum, n=10)

capture_15_16_top10_years <- capture_15_16 %>%
    filter(exporter_iso3c == "RUS", source_country_iso3c == "RUS") %>% 
  group_by(importer_iso3c, year) %>%
  summarise(sum = sum(product_weight_t)) %>%
      arrange(desc(sum)) %>% 
  filter(importer_iso3c == "CHN" | importer_iso3c == "KOR" | importer_iso3c == "NLD" | importer_iso3c == "JPN" | importer_iso3c == "BLR" | importer_iso3c == "NGA" | importer_iso3c == "UKR" | importer_iso3c == "CMR" | importer_iso3c == "KAZ" | importer_iso3c == "VNM")



```

